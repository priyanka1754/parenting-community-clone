<div class="max-w-3xl mx-auto p-4">
  <h2 class="text-2xl font-bold mb-4">My Events</h2>
  <div class="mb-6">
    <button class="btn btn-primary mr-2" [class.btn-outline]="tab !== 'created'" (click)="tab = 'created'">Created</button>
    <button class="btn btn-primary mr-2" [class.btn-outline]="tab !== 'going'" (click)="tab = 'going'">Going</button>
    <button class="btn btn-primary" [class.btn-outline]="tab !== 'interested'" (click)="tab = 'interested'">Interested</button>
  </div>
  <div *ngIf="loading" class="text-center py-8">Loading events...</div>
  <div *ngIf="!loading && events.length === 0" class="text-center py-8 text-gray-500">No events found.</div>
  <div class="grid gap-4">
    <div *ngFor="let event of events" class="border rounded-lg p-4 flex flex-col md:flex-row gap-4 bg-white shadow">
      <img *ngIf="event.coverImageUrl" [src]="event.coverImageUrl" alt="cover" class="w-full md:w-40 h-32 object-cover rounded" />
      <div class="flex-1">
        <div class="flex items-center gap-2 mb-1">
          <span class="font-semibold text-lg">{{ event.title }}</span>
          <span *ngIf="event.isCancelled" class="ml-2 px-2 py-1 bg-red-100 text-red-600 rounded text-xs">Cancelled</span>
          <span *ngIf="isEventFull(event)" class="ml-2 px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs">Full</span>
        </div>
        <div class="text-sm text-gray-500 mb-1 flex items-center gap-2">
          <span>ðŸ“… {{ event.date | date:'mediumDate' }} {{ event.time }}</span>
          <span *ngIf="event.eventType">â€¢</span>
          <span *ngIf="event.eventType === 'Online'">Online</span>
          <span *ngIf="event.eventType === 'Offline'">{{ event.location }}</span>
        </div>
        <div class="text-xs text-gray-400 mb-2">Category: {{ event.category }}</div>
        <div class="flex items-center gap-2 mb-2">
          <img [src]="event.host.avatar || '/assets/user-img.png'" class="w-6 h-6 rounded-full" />
          <span class="text-sm">{{ event.host.name }}</span>
        </div>
        <div class="flex items-center gap-4 text-xs text-gray-600">
          <span>RSVP: {{ getRSVPCount(event) }}</span>
          <span *ngIf="event.visibility && event.visibility !== 'Public'">{{ event.visibility }}</span>
        </div>
        <div class="mt-2 flex gap-2">
          <a [routerLink]="['/events', event.id]" class="btn btn-sm btn-primary">View</a>
          <button *ngIf="tab === 'created' && !event.isCancelled" class="btn btn-sm btn-outline" (click)="editEvent(event)">Edit</button>
          <button *ngIf="tab === 'created' && !event.isCancelled" class="btn btn-sm btn-error" (click)="cancelEvent(event)">Cancel</button>
          <button *ngIf="tab !== 'created' && !event.isCancelled" class="btn btn-sm btn-outline" (click)="reportEvent(event)">Report</button>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="error" class="text-red-500 mt-4 text-center">{{ error }}</div>
</div>
